#include<bits/stdc++.h>
using namespace std;
int main(){
#define int long long int 

int n;
cin>>n;

string s[n];

for (int i = 0; i < n; ++i)
{
	cin>>s[i];
}

int a[26][n+1][20];
memset(a,0,sizeof(a));

for(int i=0;i<n;i++)
	for(int j=0;j<s[i].length();j++)
		a[s[i][j]-'a'][i][j]=1;
		
		

int pre[26][n+1][20];
memset(pre,0,sizeof(pre));

for(int i=0;i<26;i++)
{
	for(int j=0;j<20;j++)
	{
			pre[i][0][j]=a[i][0][j];
	}
}

for(int i=0;i<26;i++)
{
	for(int j=1;j<n;j++)
	{
		for(int k=0;k<20;k++)
		{
			pre[i][j][k]=a[i][j][k]+pre[i][j-1][k];
		}
	}
}

int q;
cin>>q;

while(q--)
{
int l,r,p;
char c;

cin>>l>>r>>p;
cin>>c;

l--;r--;p--;
if(l==0)
cout<<pre[c-'a'][r][p]<<endl;
else
cout<<pre[c-'a'][r][p]-pre[c-'a'][l-1][p]<<endl;
}


return 0;
}